{% extends 'base.html' %}

{% block content %}
    <div class="container">
<div class="h1">Курсы валют</div>
  <div class="row">
      <div class="col-8">
        <div><canvas id="chart1"></canvas></div>
      </div>
    <div class="col-4">
        <div class="h3">Выберите период</div>
        <form action="{% url 'currency_rate' %}" method="post">
            {% csrf_token %}
            <div class="grid gap-0 row-gap-3">
                <div class="p-2 g-col-6">
                    <label class="form-label">Начальная дата</label>
                    <input name="start_date" type="date" class="form-control" value="{{start_date}}">
                </div>
                <div class="p-2 g-col-6">
                    <label class="form-label">Конечная дата</label>
                    <input name="end_date" type="date" class="form-control" value="{{end_date}}">
                </div>
                <div class="p-2 g-col-6">
                    <select name="currency" class="form-select form-select-lg mb-3" aria-label="Large select example">
                      <option value="R01235" selected>{% if currency_name != 'null' %} {{ currency_name }} {% else %}Выбрать металл {% endif %}</option>
                      <option value="R01235">Доллар США</option>
                      <option value="R01239">Евро</option>
                    </select>
                </div>
                <div class="p-2 g-col-6">
                    <button type="submit" class="btn btn-dark mb-3">Построить график</button>
                </div>
            </div>
        </form>
    </div>
  </div>

<script>
let ctx1 = document.getElementById("chart1").getContext("2d");
let chart1 = new Chart(ctx1, {
  type: "line",
  data: {
     labels: [{% for dt in dates %}"{{ dt }}",{% endfor %}],
     datasets: [
        {
          label: '{{currency_name}} (₽)',
          backgroundColor: "#AAAAAA",
          borderColor: "#34393e",
          data: {{ rates }}
        }
     ]
  },
  options: {
     title: {
        text: "Ключевая ставка",
        display: true
     }
  }
});
</script>
    </div>
{% endblock %}