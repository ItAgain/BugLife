{% extends 'base.html' %}

{% block content %}
    <div class="container">
<div class="h1">Ключевая ставка</div>
  <div class="row">
      <div class="col-8">
        <div><canvas id="chart1"></canvas></div>
      </div>
    <div class="col-4">
        <div class="h3">Выберите период</div>
                <form action="{% url 'key_rate' %}" method="post">
            {% csrf_token %}
            <div class="grid gap-0 row-gap-3">
                <div class="p-2 g-col-6">
                    <label class="form-label">Начальная дата</label>
                    <input name="start_date" type="date" class="form-control" value="{{ start_date }}">
                </div>
                <div class="p-2 g-col-6">
                    <label class="form-label">Конечная дата</label>
                    <input name="end_date" type="date" class="form-control"  value="{{ end_date }}">
                </div>
                <div class="p-2 g-col-6">
                    <button type="submit" class="btn btn-dark mb-3">Построить график</button>
                </div>
            </div>
        </form>
    </div>
      <p>{{ length }}</p>
  </div>

<script>
let ctx1 = document.getElementById("chart1").getContext("2d");
let chart1 = new Chart(ctx1, {
  type: "line",
  data: {
     labels: [{% for dt in dates %}"{{ dt }}",{% endfor %}],
     datasets: [
        {
          label: "Значение ключевой ставки (%)",
          backgroundColor: "#AAAAAA",
          borderColor: "#34393e",
          data: {{ rates }}
        }
     ]
  },
  options: {
     title: {
        text: "Ключевая ставка",
        display: true
     }
  }
});
</script>
    </div>
{% endblock %}