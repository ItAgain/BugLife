{% extends 'base.html' %}

{% block content %}
    <div class="container">
<div class="h1">Драгоценные металлы</div>
  <div class="row">
      <div class="col-8">
        <div><canvas id="chart1"></canvas></div>
      </div>
    <div class="col-4">
        <div class="h3">Выберите период</div>
        <form action="{% url 'metals_rate' %}" method="post">
            {% csrf_token %}
            <div class="grid gap-0 row-gap-3">
                <div class="p-2 g-col-6">
                    <label class="form-label">Начальная дата</label>
                    <input name="start_date" type="date" class="form-control" value="{{ start_date }}">
                </div>
                <div class="p-2 g-col-6">
                    <label class="form-label">Конечная дата</label>
                    <input name="end_date" type="date" class="form-control"  value="{{ end_date }}">
                </div>
                <div class="p-2 g-col-6">
                    <select name="cod_met" class="form-select form-select-lg mb-3" aria-label="Large select example">
                      <option value="1" selected>{% if metal_name != 'null' %} {{ metal_name }} {% else %}Выбрать металл {% endif %}</option>
                      <option value="1">Золото</option>
                      <option value="2">Серебро</option>
                      <option value="3">Платина</option>
                    </select>
                </div>
                <div class="p-2 g-col-6">
                    <button type="submit" class="btn btn-dark mb-3">Построить график</button>
                </div>
            </div>
        </form>
    </div>
  </div>

<script>
let ctx1 = document.getElementById("chart1").getContext("2d");
let chart1 = new Chart(ctx1, {
  type: "line",
  data: {
     labels: [{% for dt in dates %}"{{ dt }}",{% endfor %}],
     datasets: [
        {
          label: '{{metal_name}} (₽)',
          backgroundColor: "#AAAAAA",
          borderColor: "#34393e",
          data: {{ rates }}
        }
     ]
  },
  options: {
     title: {
        text: "Ключевая ставка",
        display: true
     }
  }
});
</script>
    </div>
{% endblock %}